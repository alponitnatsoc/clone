
{% extends "::base.html.twig" %}
{% block fos_user_content%}


{% endblock fos_user_content%}
{% block javascripts %}
{{ parent() }}
<script>
var state="/old";

jQuery(document).ready(function() {
	$(".nav-link").on("click",function(e){
		e.preventDefault();
		sendAjax($(this).attr('href'));
	});
	{# ajax que maneja los requests #}
	sendAjax(state);
});

function sendAjax (url, form) {

	$.ajax({
		url : url,
		type: $(form).attr('method'),
		data: $(form).serializeArray(),
		}).done(function(data) {
			$('#main').replaceWith(
			// ... with the returned one from the AJAX response.
			$(data).find('#main'));
			addClick();
			if (!jsLoader(url)) {
				addSumbit();
			}
		});
}
function addClick () {
	$("#main .nav-link").on("click",function(e){
		e.preventDefault();
		sendAjax($(this).attr('href'));
	});
}
function addSumbit () {
	$("form").on("submit",function(e){
		e.preventDefault();
		sendAjax($(this).attr('action'), $(this));
	});
}
function jsLoader(url){
	if(url.indexOf("{{ path('edit_profile') }}")!==-1){
		$.getScript( "{{ asset('public/js/newEmployer.js') }}").done(function(){
			startEmployer();
		})

		return true;
	}else if(url.indexOf("{{ path('register_employee') }}")!==-1){
		$.getScript( "{{ asset('public/js/newEmployee.js') }}").done(function(){
			startEmployee();
		})

		return true;
	}
	return false;
}
</script>
{% endblock javascripts %}